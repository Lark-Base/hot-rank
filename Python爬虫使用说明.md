# äºšé©¬é€Šæ–°åŠ å¡äº§å“æ•°æ®æŠ“å–å·¥å…·ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

æœ¬å·¥å…·æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæŠ“å–äºšé©¬é€Šæ–°åŠ å¡ç«™ç‚¹äº§å“æ•°æ®çš„Pythonè„šæœ¬ï¼Œç‰¹åˆ«é’ˆå¯¹ç•…é”€å•†å“é¡µé¢è¿›è¡Œä¼˜åŒ–ã€‚æ”¯æŒå¤šç§äº§å“ç±»åˆ«çš„æ•°æ®æŠ“å–ï¼ŒåŒ…æ‹¬æ—¶å°šã€ç”µå­äº§å“ã€å®¶å±…ç”¨å“ç­‰ã€‚åŸºäºå¯¹äºšé©¬é€Šæ–°åŠ å¡ç«™ç‚¹ç•…é”€æ¦œé¡µé¢ç»“æ„çš„æ·±åº¦åˆ†æå¼€å‘ï¼Œèƒ½å¤Ÿé€‚åº”ç½‘ç«™ç»“æ„çš„åŠ¨æ€å˜åŒ–ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

### ğŸ¯ æ•°æ®æŠ“å–èƒ½åŠ›
- **äº§å“æ’å**: ç•…é”€æ¦œæ’åä½ç½®
- **äº§å“æ ‡é¢˜**: å®Œæ•´çš„äº§å“åç§°
- **ä»·æ ¼ä¿¡æ¯**: æ–°åŠ å¡å…ƒ(S$)ä»·æ ¼
- **è¯„åˆ†æ•°æ®**: ç”¨æˆ·è¯„åˆ†(1-5æ˜Ÿ)
- **è¯„è®ºæ•°é‡**: ç”¨æˆ·è¯„è®ºæ€»æ•°
- **äº§å“å›¾ç‰‡**: é«˜è´¨é‡äº§å“å›¾ç‰‡URL
- **äº§å“é“¾æ¥**: å®Œæ•´çš„äº§å“è¯¦æƒ…é¡µé“¾æ¥
- **å“ç‰Œä¿¡æ¯**: è‡ªåŠ¨æå–çš„å“ç‰Œåç§°
- **åˆ†ç±»ä¿¡æ¯**: äº§å“æ‰€å±ç±»åˆ«

### ğŸ›¡ï¸ åæ£€æµ‹æœºåˆ¶
- **éšæœºå»¶è¿Ÿ**: è¯·æ±‚é—´éš”éšæœºåŒ–ï¼Œé¿å…è¢«è¯†åˆ«ä¸ºæœºå™¨äºº
- **çœŸå®æµè§ˆå™¨å¤´**: æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨çš„User-Agentå’Œè¯·æ±‚å¤´
- **ä¼šè¯ä¿æŒ**: ä½¿ç”¨Sessionç»´æŒè¿æ¥çŠ¶æ€
- **é‡è¯•æœºåˆ¶**: è‡ªåŠ¨é‡è¯•å¤±è´¥çš„è¯·æ±‚
- **éªŒè¯ç æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«å¹¶å¤„ç†éªŒè¯ç é¡µé¢

### ğŸ“Š æ•°æ®è¾“å‡ºæ ¼å¼
- **CSVæ ¼å¼**: ä¾¿äºExcelæ‰“å¼€å’Œæ•°æ®åˆ†æ
- **JSONæ ¼å¼**: ä¾¿äºç¨‹åºå¤„ç†å’ŒAPIé›†æˆ
- **UTF-8ç¼–ç **: å®Œç¾æ”¯æŒä¸­æ–‡å’Œç‰¹æ®Šå­—ç¬¦

## å®‰è£…å’Œç¯å¢ƒé…ç½®

### 1. Pythonç¯å¢ƒè¦æ±‚
```bash
# ç¡®ä¿Pythonç‰ˆæœ¬ >= 3.7
python --version
```

### 2. å®‰è£…ä¾èµ–åŒ…
```bash
# ä½¿ç”¨pipå®‰è£…æ‰€éœ€ä¾èµ–
pip install -r requirements.txt

# æˆ–è€…æ‰‹åŠ¨å®‰è£…
pip install requests beautifulsoup4 pandas lxml
```

### 3. ä¾èµ–åŒ…è¯´æ˜
- **requests**: HTTPè¯·æ±‚åº“ï¼Œç”¨äºç½‘é¡µæŠ“å–
- **beautifulsoup4**: HTMLè§£æåº“ï¼Œç”¨äºæå–æ•°æ®
- **pandas**: æ•°æ®å¤„ç†åº“ï¼Œç”¨äºCSVå¯¼å‡º
- **lxml**: XML/HTMLè§£æå™¨ï¼Œæé«˜è§£ææ€§èƒ½

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨
```bash
# ç›´æ¥è¿è¡Œè„šæœ¬
python amazon_scraper.py
```

### é«˜çº§ä½¿ç”¨

#### 1. ä¿®æ”¹ç›®æ ‡URL
```python
# åœ¨main()å‡½æ•°ä¸­ä¿®æ”¹urlå˜é‡
url = "https://www.amazon.sg/gp/bestsellers/ä½ çš„ç›®æ ‡åˆ†ç±»/"
```

#### 2. è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å
```python
# ä¿®æ”¹ä¿å­˜æ–‡ä»¶å
scraper.save_to_csv(products, 'my_products.csv')
scraper.save_to_json(products, 'my_products.json')
```

#### 3. è°ƒæ•´æŠ“å–å‚æ•°
```python
# ä¿®æ”¹è¯·æ±‚å»¶è¿Ÿæ—¶é—´
time.sleep(random.uniform(2, 5))  # å¢åŠ å»¶è¿Ÿæ—¶é—´

# ä¿®æ”¹é‡è¯•æ¬¡æ•°
soup = self.get_page(url, max_retries=5)
```

## è¾“å‡ºæ•°æ®æ ¼å¼

### CSVæ–‡ä»¶ç¤ºä¾‹
```csv
rank,title,price,rating,review_count,image_url,product_url,brand,category
1,"rosyclo Cloud Slippers for Women and Men, Pillow House Slippers Shower Shoes Indoor Slides Bathroom Sandals, Ultimate Comfort, Lightweight, Thick Sole, Non-Slip, Easy to Clean","S$42.14","4.2","20118","https://images-fe.ssl-images-amazon.com/images/I/710IlAOol2S._AC_UL300_SR300,200_.jpg","https://www.amazon.sg/rosyclo-Slippers-Bathroom-Ultimate-Lightweight/dp/B0BHL28RVT","rosyclo","Women's Slippers"
2,"Nike Air Max Verona Women's Running Shoes","S$423.27","4.2","156","https://...","https://...","Nike","Women's Sports and Outdoor Shoes"
```

### JSONæ–‡ä»¶ç¤ºä¾‹
```json
[
  {
    "rank": "1",
    "title": "rosyclo Cloud Slippers for Women and Men, Pillow House Slippers Shower Shoes Indoor Slides Bathroom Sandals, Ultimate Comfort, Lightweight, Thick Sole, Non-Slip, Easy to Clean",
    "price": "S$42.14",
    "rating": "4.2",
    "review_count": "20118",
    "image_url": "https://images-fe.ssl-images-amazon.com/images/I/710IlAOol2S._AC_UL300_SR300,200_.jpg",
    "product_url": "https://www.amazon.sg/rosyclo-Slippers-Bathroom-Ultimate-Lightweight/dp/B0BHL28RVT",
    "brand": "rosyclo",
    "category": "Women's Slippers"
  }
]
```

## æŠ€æœ¯å®ç°ç»†èŠ‚

### ç½‘ç«™ç»“æ„åˆ†æ

åŸºäºå¯¹ç›®æ ‡ç½‘ç«™çš„åˆ†æï¼Œè¯¥è„šæœ¬é’ˆå¯¹ä»¥ä¸‹HTMLç»“æ„è¿›è¡Œäº†ä¼˜åŒ–ï¼š

1. **äº§å“å®¹å™¨é€‰æ‹©å™¨**:
   - `li.zg-no-numbers` - ä¸»è¦çš„ç•…é”€å•†å“å®¹å™¨
   - `.zg-item-immersion` - å¤‡ç”¨é€‰æ‹©å™¨
   - `.s-result-item` - æœç´¢ç»“æœé¡¹
   - `[data-component-type="s-search-result"]` - ç»„ä»¶ç±»å‹æ ‡è¯†

2. **æ•°æ®æå–é€‰æ‹©å™¨**:
   - æ’å: `.zg-bdg-text`
   - æ ‡é¢˜: `._cDEzb_p13n-sc-css-line-clamp-3_g3dy1`, `img[alt]`
   - ä»·æ ¼: `._cDEzb_p13n-sc-price_3mJ9Z`, `.a-price-whole`
   - è¯„åˆ†: `.a-icon-alt`
   - å›¾ç‰‡: `img.a-dynamic-image`, `img[src]`, `img[data-src]`
   - é“¾æ¥: `a.a-link-normal[href]`

### é”™è¯¯å¤„ç†æœºåˆ¶

```python
# ç½‘ç»œè¯·æ±‚é”™è¯¯å¤„ç†
try:
    response = self.session.get(url, timeout=30)
    response.raise_for_status()
except requests.RequestException as e:
    print(f"è¯·æ±‚å¤±è´¥: {e}")
    
# æ•°æ®è§£æé”™è¯¯å¤„ç†
try:
    product_info = self.extract_product_info(element)
except Exception as e:
    print(f"è§£æäº§å“ä¿¡æ¯æ—¶å‡ºé”™: {e}")
```

## å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 1. è®¿é—®è¢«æ‹’ç» (403/429é”™è¯¯)
**åŸå› **: è¯·æ±‚é¢‘ç‡è¿‡é«˜æˆ–è¢«è¯†åˆ«ä¸ºæœºå™¨äºº

**è§£å†³æ–¹æ¡ˆ**:
- å¢åŠ è¯·æ±‚é—´éš”æ—¶é—´
- æ›´æ¢User-Agent
- ä½¿ç”¨ä»£ç†æœåŠ¡å™¨
- å‡å°‘å¹¶å‘è¯·æ±‚

### 2. éªŒè¯ç é¡µé¢
**ç°è±¡**: é¡µé¢è¿”å›éªŒè¯ç æˆ–"è¯æ˜ä½ ä¸æ˜¯æœºå™¨äºº"

**è§£å†³æ–¹æ¡ˆ**:
- è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶é‡è¯•
- æ‰‹åŠ¨åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä¸€æ¬¡ç½‘ç«™
- æ›´æ¢IPåœ°å€æˆ–ä½¿ç”¨VPN

### 3. æ•°æ®æå–ä¸å®Œæ•´
**åŸå› **: ç½‘ç«™ç»“æ„å‘ç”Ÿå˜åŒ–

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ§åˆ¶å°è¾“å‡ºçš„è°ƒè¯•ä¿¡æ¯
- æ›´æ–°CSSé€‰æ‹©å™¨
- æŸ¥çœ‹ç½‘é¡µæºä»£ç ç¡®è®¤ç»“æ„å˜åŒ–

### 4. ç¼–ç é—®é¢˜
**ç°è±¡**: ä¸­æ–‡å­—ç¬¦æ˜¾ç¤ºä¹±ç 

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿ä½¿ç”¨UTF-8ç¼–ç ä¿å­˜æ–‡ä»¶
- åœ¨Excelä¸­é€‰æ‹©UTF-8ç¼–ç æ‰“å¼€CSV

## æ³•å¾‹å’Œé“å¾·è€ƒè™‘

### âš–ï¸ ä½¿ç”¨é¡»çŸ¥
1. **éµå®ˆrobots.txt**: å°Šé‡ç½‘ç«™çš„çˆ¬è™«åè®®
2. **åˆç†ä½¿ç”¨é¢‘ç‡**: é¿å…å¯¹æœåŠ¡å™¨é€ æˆè¿‡å¤§è´Ÿæ‹…
3. **æ•°æ®ä½¿ç”¨è§„èŒƒ**: ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œç ”ç©¶ç›®çš„
4. **ç‰ˆæƒå°Šé‡**: ä¸å¾—ç”¨äºå•†ä¸šç”¨é€”æˆ–ä¾µçŠ¯ç‰ˆæƒ

### ğŸ”’ éšç§ä¿æŠ¤
- ä¸æ”¶é›†ç”¨æˆ·ä¸ªäººä¿¡æ¯
- ä»…æŠ“å–å…¬å¼€çš„äº§å“ä¿¡æ¯
- ä¸å­˜å‚¨ç”¨æˆ·è¡Œä¸ºæ•°æ®

## æ‰©å±•å’Œå®šåˆ¶

### æ·»åŠ æ–°çš„æ•°æ®å­—æ®µ
```python
# åœ¨extract_product_infoæ–¹æ³•ä¸­æ·»åŠ 
product_info['new_field'] = ''

# æ·»åŠ æå–é€»è¾‘
new_elem = product_element.select_one('.new-selector')
if new_elem:
    product_info['new_field'] = new_elem.get_text(strip=True)
```

### æ”¯æŒå…¶ä»–äºšé©¬é€Šç«™ç‚¹
```python
# ä¿®æ”¹base_url
self.base_url = 'https://www.amazon.com'  # ç¾å›½ç«™
self.base_url = 'https://www.amazon.co.uk'  # è‹±å›½ç«™
self.base_url = 'https://www.amazon.de'  # å¾·å›½ç«™
```

### æ·»åŠ æ•°æ®åº“å­˜å‚¨
```python
import sqlite3

def save_to_database(self, products):
    conn = sqlite3.connect('amazon_products.db')
    df = pd.DataFrame(products)
    df.to_sql('products', conn, if_exists='append', index=False)
    conn.close()
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¹¶å‘æ§åˆ¶**: ä½¿ç”¨çº¿ç¨‹æ± ä½†é™åˆ¶å¹¶å‘æ•°
2. **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜å·²è®¿é—®çš„é¡µé¢
3. **å¢é‡æ›´æ–°**: åªæŠ“å–æ–°å¢æˆ–å˜åŒ–çš„æ•°æ®
4. **æ•°æ®å‹ç¼©**: å¯¹å¤§é‡æ•°æ®è¿›è¡Œå‹ç¼©å­˜å‚¨

## æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Pythonå’Œä¾èµ–åŒ…ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. ç›®æ ‡ç½‘ç«™æ˜¯å¦å¯æ­£å¸¸è®¿é—®
4. æ§åˆ¶å°è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯

---

**å…è´£å£°æ˜**: æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨é£é™©ï¼Œå¹¶éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œç½‘ç«™æœåŠ¡æ¡æ¬¾ã€‚